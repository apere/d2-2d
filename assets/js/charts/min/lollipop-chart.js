function makeLollipopChart(t,a,e,n,r){function i(a){d(a),J=d3.selectAll(t+" .datum"),J.on("mouseover",function(a,e){var n=a,r=J.filter(function(t){return n===t});d3.selectAll(t+" .active").classed("active",!1),r.classed("active",!0)}).on("mouseout",function(t,a){var e=t,n=J.filter(function(t){return e===t});n.classed("active",!1)}).on("click",function(t,a){console.log(t)})}function l(t,a){return T(t.key)}function o(t,a,e){return(void 0===e||null===e)&&(e=0),w(t.avg)+e}function c(t,a){return t.avg>=P/3?M(t.avg):z(t.avg)}function s(t,a){var e=800*t.avg/P;return e>300?e:1200*t.avg/P}function u(){var a=d3.selectAll(t+" line"),e=d3.selectAll(t+" circle");a.transition().duration(s).delay(s).ease("elastic").attr("y2",function(t,a){return o(t,a,W)}),e.transition().duration(600).delay(s).ease("elastic").attr("r",W).attr("cy",o)}function d(a){q=D.selectAll(t+" .point").data(a,function(t){return t.key});var n=q.exit(),i=n.selectAll(t+" line.datum.point-line"),s=n.selectAll(t+" circle.datum.point-circle");i.transition().delay(345).duration(300).ease("linear").attr("stroke-opacity",0).attr("x1",function(t,a){return g+A.right+A.left+20}).attr("x2",function(t,a){return g+A.right+A.left+20}).attr("stroke-opacity",0),s.transition().duration(300).delay(0).ease("linear").attr("cx",function(t,a){return g+A.right+A.left+20}).attr("fill-opacity",0),setTimeout(function(){n.remove()},800);var d=q.enter().append("g").attr("class","point").each(function(t){t.avg>P&&(P=t.avg),t.avg<V&&(V=t.avg)});d.append("circle").attr("class","datum point-circle"),d.append("line").attr("class","datum point-line"),d.append("g").attr("class","datum label-post-count");var p=d3.selectAll(t+" .datum.point-line"),f=d3.selectAll(t+" .datum.point-circle"),m=d3.selectAll(t+" .datum.label-post-count");F.transition().duration(800).attr("opacity",0),setTimeout(function(){F.attr("opacity",1).html(""),F.append("text").attr("text-anchor","middle").classed("day-date",!0).text(e).attr("x",function(){var t=(g-A.left-A.right)/2;return A.left+t}).attr("y",h-7).attr("opacity",0),d3.selectAll(t+" .day-date").transition().duration(800).attr("opacity",1)},850),w.domain([P,0]),M.domain([P/3,P]),z.domain([V,P/3]),d3.selectAll(t+" .y-axis").transition().duration(600).ease("sin-in-out").call(G),d3.selectAll(t+" .x-axis").transition().duration(600).ease("sin-in-out").call(E),p.attr("x1",l).attr("x2",l).attr("y1",function(t,a){return h-A.bottom}).attr("y2",function(t,a){return h-A.bottom}).style("stroke-opacity",c),f.attr("r",0).attr("cx",l).attr("cy",h).style("fill-opacity",c),m.append("rect").attr("class","label-background").attr("x",function(t,a){return l(t,0)-50}).attr("y",function(t,a){return o(t,a,2*W-90)}).attr("width",100).attr("height",65).attr("rx",2).attr("ry",2),m.append("text").attr("class","post-count-numb").attr("x",l).attr("y",function(t,a){return o(t,a,2*W-63)}).attr("text-anchor","middle").text(function(t,a){return t.avg.toFixed(2)}),m.append("text").attr("class","post-count-lab").attr("text-anchor","middle").attr("x",l).attr("y",function(t,a){return o(t,a,2*W-49)}).text(r),m.append("text").attr("class","post-count-date").attr("text-anchor","middle").attr("x",l).attr("y",function(t,a){return o(t,a,2*W-34)}).text(function(t,a){return t.key}),setTimeout(function(){var a=d3.selectAll(t+" .datum").filter(function(t){return Math.round(10*P)/10===Math.round(10*t.avg)/10});a.classed("active",!0)},1600),u()}for(var p=[],f={},m=[],x=[],y=0;y<a.length;y++){f={};for(key in a[y])f[key]=a[y][key];p.push(f),m.push(a[y].key),y%n===0&&x.push(a[y].key)}var g=$(t).innerWidth()-20,v=g+"px",h=450,k=h+"px",A={top:95,bottom:60,left:15,right:15},b={},T=d3.scale.ordinal().domain(m).rangePoints([A.left,g-A.right]),w=d3.scale.linear().domain([0,100]).range([A.top,h-A.bottom]),M=d3.scale.linear().domain([0,100]).range([.4,.7]),z=d3.scale.linear().domain([0,100]).range([.05,.3]),C=d3.select(t+" .viz-content").append("svg").attr("width",v).attr("height",k),F=C.append("g").attr("class","hours-title"),L=C.append("g").attr("class","axes"),P=0,V=p[0].avg,W=3,j=d3.selectAll(t+" .datum.circle-points"),q,B,D=C.append("g").attr("class","point-layer"),E=d3.svg.axis().scale(T).orient("bottom");L.append("g").attr("class","axis x-axis").attr("transform","translate(0,"+(h-A.bottom)+")").call(E),E.tickValues(x);var G=d3.svg.axis().scale(w).orient("left").ticks(5);L.append("g").attr("class","axis y-axis").attr("transform","translate("+A.left+",0)").call(G),i(p);var H,I,J;u()}