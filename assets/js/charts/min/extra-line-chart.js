function makeExtraLine(t,e){for(var a=[],n={},r={numberOfDocuments:0},s={numberOfDocuments:e[0].numberOfDocuments},o=0;o<e.length;o++)o%7===0?(n={},n.startDate=new Date(e[o].startDate),n.startDate.setTime(n.startDate.getTime()+6e4*Math.abs(n.startDate.getTimezoneOffset())),n.total=parseInt(e[o].numberOfDocuments),n.count=1):(n.total=n.total+parseInt(e[o].numberOfDocuments),n.count=n.count+1,n.endDate=new Date(e[o].endDate),n.endDate.setTime(n.endDate.getTime()+6e4*Math.abs(n.endDate.getTimezoneOffset()))),(o+1)%7===0&&(n.numberOfDocuments=n.total/n.count,n.numberOfDocuments>=r.numberOfDocuments&&(r=n),n.numberOfDocuments<=s.numberOfDocuments&&(s=n),a.push(n),n={});n.total&&(n.numberOfDocuments=n.total/n.count,a.push(n));var i=$(t).innerWidth()-20,c=i+"px",m=150,u=m+"px",d={top:10,bottom:25,left:10,right:10},l=d3.time.scale().range([d.left,i-d.right]),p=d3.scale.linear().range([d.top,m-d.bottom]),D=d3.svg.axis().scale(l).orient("bottom").tickValues([a[0].startDate,a[parseInt((a.length-1)/2)].startDate,a[a.length-1].startDate]).tickFormat(d3.time.format("%b '%y"));l.domain(d3.extent(a,function(t){return t.startDate})),p.domain([d3.max(a,function(t){return parseInt(t.numberOfDocuments)}),0]);var f=d3.select(t+" .viz-content").append("svg").attr("width",c).attr("height",u),y=d3.svg.line().x(function(t){return l(t.startDate)}).y(function(t){return parseInt(p(parseInt(t.numberOfDocuments)))}),b=f.append("g").attr("class","max-min-point"),x=f.append("g").attr("class","max-min-point"),g=f.append("path").attr("class","line").attr("d",y(a));console.log(g);var h=g.node().getTotalLength();g.attr("stroke-dasharray",h+" "+h).attr("stroke-dashoffset",h).transition().duration(2e3).delay(750).ease("sin-out").attr("stroke-dashoffset",0);var O=f.append("g").attr("class","x axis").attr("transform","translate(0,"+(m-d.bottom)+")").call(D);O.select(".tick text").style("text-anchor","start"),O.select(".tick:last-of-type text").style("text-anchor","end");var v=f.append("g").attr("class","first-date").append("circle").attr("r",3).attr("cx",l(a[0].startDate)).attr("cy",p(a[0].numberOfDocuments)+2).attr("opacity",0).transition().duration(1500).attr("opacity",1),k=f.append("g").attr("class","first-date").append("circle").attr("r",0).attr("cx",l(a[a.length-1].startDate)).attr("cy",p(a[a.length-1].numberOfDocuments)+2).attr("opacity",0).transition().duration(1200).delay(2500).ease("elastic").attr("opacity",1).attr("r",6).transition().duration(2e3).ease("bounce").attr("r",3);b.append("line").attr("x1",l(r.startDate)).attr("x2",l(r.startDate)).attr("y1",m-d.bottom).attr("y2",m-d.bottom).transition().delay(900).duration(1e3).attr("y2",p(r.numberOfDocuments)+2),b.append("text").text(r.numberOfDocuments.toFixed(0)+" posts").attr("text-anchor","end").attr("x",l(r.startDate)-5).attr("y",p(r.numberOfDocuments)+10).style("opacity",0).transition().delay(1700).duration(300).style("opacity",1),x.append("line").attr("x1",l(s.startDate)).attr("x2",l(s.startDate)).attr("y1",m-d.bottom).attr("y2",m-d.bottom).transition().delay(1900).duration(1e3).attr("y2",p(s.numberOfDocuments)),x.append("text").text(s.numberOfDocuments.toFixed(0)+" posts").attr("text-anchor","end").attr("x",l(s.startDate)-4).attr("y",p(s.numberOfDocuments)+10).style("opacity",0).transition().delay(2400).duration(300).style("opacity",1)}